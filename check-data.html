<!DOCTYPE html>
<html>
<head>
    <title>Check Session Data</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, getDocs, doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBQqJqJqJqJqJqJqJqJqJqJqJqJqJqJqJq",
            authDomain: "perfect-day-1eb92.firebaseapp.com",
            projectId: "perfect-day-1eb92",
            storageBucket: "perfect-day-1eb92.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function checkData() {
            try {
                console.log('üîç Checking session data...');
                
                // Get all users
                const usersSnapshot = await getDocs(collection(db, 'users'));
                console.log(`Found ${usersSnapshot.size} user(s)`);
                
                for (const userDoc of usersSnapshot.docs) {
                    const userId = userDoc.id;
                    console.log(`\nüë§ User: ${userId}`);
                    
                    // Check today's date (2025-09-09)
                    const today = '2025-09-09';
                    
                    // Check daily records
                    const dailyRef = doc(db, 'users', userId, 'dailyRecords', today);
                    const dailySnap = await getDoc(dailyRef);
                    
                    if (dailySnap.exists()) {
                        const dailyData = dailySnap.data();
                        console.log('üìä Daily data:', dailyData);
                        document.getElementById('results').innerHTML += `<h3>Daily Data for ${today}:</h3><pre>${JSON.stringify(dailyData, null, 2)}</pre>`;
                    } else {
                        console.log('‚ùå No daily data found');
                        document.getElementById('results').innerHTML += '<p>‚ùå No daily data found</p>';
                    }
                    
                    // Check session blocks
                    const sessionsRef = collection(db, 'users', userId, 'sessions', today, 'blocks');
                    const sessionsSnapshot = await getDocs(sessionsRef);
                    
                    if (!sessionsSnapshot.empty) {
                        console.log(`üéØ Found ${sessionsSnapshot.size} session(s)`);
                        document.getElementById('results').innerHTML += `<h3>Sessions for ${today}:</h3>`;
                        
                        sessionsSnapshot.forEach((sessionDoc, index) => {
                            const sessionData = sessionDoc.data();
                            console.log(`Session ${index + 1}:`, sessionData);
                            document.getElementById('results').innerHTML += `<h4>Session ${index + 1}:</h4><pre>${JSON.stringify(sessionData, null, 2)}</pre>`;
                        });
                    } else {
                        console.log('‚ùå No sessions found');
                        document.getElementById('results').innerHTML += '<p>‚ùå No sessions found</p>';
                    }
                }
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                document.getElementById('results').innerHTML += `<p>‚ùå Error: ${error.message}</p>`;
            }
        }

        // Run when page loads
        checkData();
    </script>
</head>
<body>
    <h1>Session Data Checker</h1>
    <div id="results"></div>
</body>
</html>
